<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마이페이지 - hub</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .grid { display:grid; gap:16px; grid-template-columns: 1fr 1fr; }
        .panel { background:#fff; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.05); }
        .panel-header { padding:14px 16px; border-bottom:1px solid #eee; font-weight:700; }
        .panel-body { padding:16px; }
        .field { margin-bottom:12px; }
        .field label { display:block; font-weight:600; margin-bottom:6px; }
        .field input, .field textarea, .field select { width:100%; padding:12px 14px; border:1px solid #eee; border-radius:10px; background:#fff; }
        @media(max-width: 900px){ .grid{ grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <header id="main-header">
        <nav class="container">
            <div class="logo">
                <a href="index.html"><img src="logo.png" alt="Hub Logo" style="height:64px; vertical-align:middle; margin-right:8px;"></a>
            </div>
            <ul class="nav-links">
                <li><a href="index.html#features">서비스 소개</a></li>
                <li>
                    <a href="chat.html">랜덤 매칭</a>
                    <div class="dropdown-menu">
                        <a href="chat.html#random">랜덤 1대1 채팅</a>
                        <a href="chat.html#group">그룹 채팅</a>
                    </div>
                </li>
                <li>
                    <a href="boards.html">게시판</a>
                    <div class="dropdown-menu">
                        <a href="boards.html#ai">AI융합부</a>
                        <a href="boards.html#bible">성서학과</a>
                        <a href="boards.html#nursing">간호학과</a>
                        <a href="boards.html#child">영유아보육학과</a>
                        <a href="boards.html#social">사회복지학과</a>
                    </div>
                </li>
                <li><a href="mypage.html">마이페이지</a></li>
            </ul>
            <div class="auth-buttons">
                <a href="login.html" class="btn btn-secondary">로그인</a>
                <a href="signup.html" class="btn btn-primary">회원가입</a>
            </div>
        </nav>
    </header>

    <main class="container" style="padding:24px 0;">
        <div class="grid">
            <section class="panel">
                <div class="panel-header">내 익명카드</div>
                <div class="panel-body">
                    <div id="anon-view">
                        <div class="field"><label>학번</label><div id="mv_year">-</div></div>
                        <div class="field"><label>성별</label><div id="mv_gender">-</div></div>
                        <div class="field"><label>자기소개</label><div id="mv_bio">-</div></div>
                        <div class="field"><label>관심사</label><div id="mv_interests">-</div></div>
                        <div style="display:flex; gap:8px;">
                            <a class="btn btn-secondary" href="chat.html">채팅에서 수정</a>
                            <button id="edit-here" class="btn btn-primary">바로 수정</button>
                        </div>
                    </div>
                    <div id="anon-edit" style="display:none;">
                        <form id="anon-edit-form">
                            <div class="field">
                                <label>몇 학번인가요?</label>
                                <select id="ep_year" style="width:100%; padding:12px 14px; border:1px solid #eee; border-radius:10px;">
                                    <option value="">선택</option>
                                    <option>25학번</option>
                                    <option>24학번</option>
                                    <option>23학번</option>
                                    <option>22학번</option>
                                    <option>21학번</option>
                                </select>
                            </div>
                            <div class="field">
                                <label>성별</label>
                                <div class="segmented">
                                    <button type="button" class="btn" data-gender="남자">남자</button>
                                    <button type="button" class="btn" data-gender="여자">여자</button>
                                    <button type="button" class="btn" data-gender="비공개">비공개</button>
                                </div>
                            </div>
                            <div class="field">
                                <label>자기소개 (최대 100자)</label>
                                <textarea id="ep_bio" rows="4" maxlength="100" style="width:100%; padding:12px 14px; border:1px solid #eee; border-radius:10px;"></textarea>
                            </div>
                            <div class="field">
                                <label>관심사</label>
                                <div id="ep_interests"></div>
                                <div style="display:flex; gap:8px; margin-top:8px;">
                                    <input id="ep_interest_input" placeholder="관심사 직접 입력" style="flex:1; padding:12px 14px; border:1px solid #eee; border-radius:10px;" />
                                    <button type="button" class="btn btn-secondary" id="ep_add_interest">추가</button>
                                </div>
                            </div>
                            <div style="display:flex; gap:8px;">
                                <button type="submit" class="btn btn-primary" style="flex:1;">저장</button>
                                <button type="button" id="ep_cancel" class="btn btn-secondary" style="flex:1;">취소</button>
                            </div>
                        </form>
                    </div>
                </div>
            </section>
            <section class="panel">
                <div class="panel-header">계정 관리</div>
                <div class="panel-body">
                    <div class="field">
                        <label>현재 비밀번호</label>
                        <input type="password" />
                    </div>
                    <div class="field">
                        <label>새 비밀번호</label>
                        <input type="password" />
                    </div>
                    <div class="field">
                        <label>새 비밀번호 확인</label>
                        <input type="password" />
                    </div>
                    <button class="btn btn-primary" style="width:100%;">비밀번호 변경</button>
                    <hr style="margin:16px 0; border:none; border-top:1px solid #eee;" />
                    <button class="btn btn-secondary" style="width:100%;">로그아웃</button>
                    <div style="text-align:center; margin-top:8px; font-size:0.9rem; color:#777;">(옵션) 회원 탈퇴</div>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 KBU Hub. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', function(){
        function load(){ try{ return JSON.parse(localStorage.getItem('anonProfile')||'null'); }catch(e){ return null; } }
        function save(p){ localStorage.setItem('anonProfile', JSON.stringify(p)); }
        function render(){
            const p = load();
            document.getElementById('mv_year').textContent = p?.year || '-';
            document.getElementById('mv_gender').textContent = p?.gender || '-';
            document.getElementById('mv_bio').textContent = p?.bio || '-';
            document.getElementById('mv_interests').textContent = (p?.interests||[]).join(', ') || '-';
        }
        render();

        const view = document.getElementById('anon-view');
        const edit = document.getElementById('anon-edit');
        document.getElementById('edit-here').addEventListener('click', ()=>{
            // hydrate edit form
            const p = load() || { year:'', gender:'비공개', bio:'', interests:[] };
            document.getElementById('ep_year').value = p.year || '';
            const gbtns = Array.from(document.querySelectorAll('#anon-edit [data-gender]'));
            gbtns.forEach(b=>b.classList.toggle('active', b.dataset.gender===p.gender));
            const wrap = document.getElementById('ep_interests');
            wrap.innerHTML = '';
            (p.interests||[]).forEach(v=>{ const s=document.createElement('span'); s.className='chip selected'; s.dataset.value=v; s.textContent=v; wrap.appendChild(s); });
            document.getElementById('ep_bio').value = p.bio || '';
            view.style.display='none'; edit.style.display='block';
        });
        document.getElementById('ep_cancel').addEventListener('click', ()=>{ edit.style.display='none'; view.style.display='block'; });
        const gbtns2 = Array.from(document.querySelectorAll('#anon-edit [data-gender]'));
        gbtns2.forEach(btn=>btn.addEventListener('click', ()=>{ gbtns2.forEach(b=>b.classList.remove('active')); btn.classList.add('active'); }));
        const wrap2 = document.getElementById('ep_interests');
        wrap2.addEventListener('click', (e)=>{ if(e.target.classList.contains('chip')) e.target.classList.toggle('selected'); });
        document.getElementById('ep_add_interest').addEventListener('click', ()=>{
            const v = document.getElementById('ep_interest_input').value.trim(); if(!v) return; const s=document.createElement('span'); s.className='chip selected'; s.dataset.value=v; s.textContent=v; wrap2.appendChild(s); document.getElementById('ep_interest_input').value='';
        });
        document.getElementById('anon-edit-form').addEventListener('submit', (e)=>{
            e.preventDefault();
            const year = document.getElementById('ep_year').value;
            const gender = (Array.from(document.querySelectorAll('#anon-edit [data-gender].active'))[0]||{}).dataset?.gender || '비공개';
            const bio = document.getElementById('ep_bio').value.trim();
            const interests = Array.from(wrap2.querySelectorAll('.chip.selected')).map(c=>c.dataset.value);
            save({ year, gender, bio, interests });
            edit.style.display='none'; view.style.display='block';
            render();
            alert('익명 프로필이 저장되었습니다.');
        });
    });
    </script>
    <script src="script.js"></script>
</body>
</html>


